<%- include("../../views/partials/user/header") %>

<div class="d-flex" style="min-height: 100vh;">
  <!-- Sidebar -->
  <div>
    <%- include("../../views/partials/user/sidebar") %>
  </div>

  <div class="row d-flex flex-wrap" style="margin-top: 100px; margin-left: 100px; margin-bottom: 50px; gap: 20px;">
    <% if (userAddress) { %>
      <% userAddress.address.forEach((address) => { %>
        <div class="col-lg-5 d-flex">
          <div class="card mb-3 w-100 h-100">
            <div class="card-header" style="background-color: #72d5a4;">
              <h5 class="mb-0 text-white"><%= address.addressType %></h5>
            </div>
            <div class="card-body d-flex flex-column justify-content-between">
              <address>
                <%= address.name %><br>
                <%= address.city %><br>
                <%= address.landMark %><br>
                <%= address.state %><br>
                <%= address.pincode %><br>
                <%= address.phone %><br>
                <%= address.altPhone %>
              </address>
              <div class="d-flex justify-content-between">
                <a href="/editAddress?id=<%= address._id %>" class="btn btn-sm btn-outline-primary">Edit</a>
                <a href="/deleteAddress?id=<%= address._id %>" class="btn-small delete-address">Delete</a>
              </div>
            </div>
          </div>
        </div>
      <% }) %>
    <% } else { %>
      <div class="col-lg-6">
        <div class="card mb-3">
          <div class="card-header">
            <h5 class="mb-0">No Address</h5>
          </div>
          <div class="card-body">
            <address>No address available.</address>
          </div>
        </div>
      </div>
    <% } %>
  
    <div class="col-lg-5">
      <a href="/addAddress">
        <button style="background-color: blue; border: none; color: white; margin-top: 15px; border-radius: 10px; width: 150px; height: 40px;">
          Add Address
        </button>
      </a>
    </div>
  </div>
  
               
            </div>
            <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
  document.querySelectorAll('a[href^="/deleteAddress"]').forEach(link => {
    link.addEventListener('click', function (e) {
      e.preventDefault(); // prevent default navigation
      const url = this.getAttribute('href');

      Swal.fire({
        title: 'Are you sure?',
        text: "Do you really want to delete this address?",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#d33',
        cancelButtonColor: '#3085d6',
        confirmButtonText: 'Yes, delete it!',
        cancelButtonText: 'Cancel'
      }).then((result) => {
        if (result.isConfirmed) {
          window.location.href = url;
        }
      });
    });
  });
</script>
